# Not generated by anybody in particular
# Definitely amalgamated by me from other anacondas

# Use cmdline based install
cmdline

url --url="http://mirror.datto.com/fedora/primary/releases/34/Everything/x86_64/os/"

# Keyboard layouts
keyboard --xlayouts='us (dvorak)'
# System language
lang en_US.UTF-8

# Network config
network --hostname=dev

# Services
services --enabled="sshd"

# Disk partitioning configuration
ignoredisk --only-use=sda
bootloader --location=mbr --timeout=1
autopart --type=btrfs
zerombr
clearpart --all --initlabel

shutdown

# System timezone
timezone America/New_York --utc

# Root password
rootpw --lock

# Set up user
user --name=sramanujam --groups=wheel --gecos="Sri Ramanujam" --lock

# Set user ssh key
sshkey --username=sramanujam "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCdoHM5jBLqp0BXURGQUkVeoA9PlV/YJPoSdLNFtNLwivu6blstziXzeAamzm+zZhUTA0I7OsO3JiiZ4K53pdi+Bg/ABn2xaN4R2fJd0ws8d5fPRwUT36znQtCY2I0dJiggyr1llLOrEhk7lPPxoEzjpBwrb6IiB8h4553M8fngJr5ZAWacH7bG0Rfq3qJdAFCuVK8HytyGfe2+VbUE6z+XQrRldQXLAnkMxMOrsvJRxWehUnfBkoS6MaJaq6sqFIbRchck+1WyxpTGQxdC33vgBfw0W1HWXdbAdZFQ8Nn4dKKPdCoPhanafqgBXI2spLxpq6T5Ba/aUFNKWsF+xlF9"

%packages
@^minimal-environment
hyperv-daemons
%end

%post --erroronfail
cat > /etc/udev/rules.d/85-block-scheduler.rules << EOFUDEV
# set scheduler for all disks to be none. Let the host OS handle it.
ACTION=="add|change", KERNEL=="sd[a-z]|vd[a-z]", ATTR{queue/scheduler}="none"
EOFUDEV

cat > /etc/sudoers.d/sramanujam-user << EOFSUDO
sramanujam ALL=(ALL) NOPASSWD:ALL
EOFSUDO

%end
